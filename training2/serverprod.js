'use strict';
const express = require('express');
const cors = require('cors');
const bodyParser = require('body-parser');
const path = require("path");
const favicon = require('serve-favicon')


// *************************************************************************************************************
// init express
// *************************************************************************************************************

const app = express();
console.info(`running express server`);

// *************************************************************************************************************
// form body parser
// *************************************************************************************************************

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({
    extended: true
}));

// *************************************************************************************************************
// routes
// *************************************************************************************************************

//const homeRoute = require('../route/home');

// *************************************************************************************************************
// enable cors
// *************************************************************************************************************

app.use(cors());

// *************************************************************************************************************
// define routes
// *************************************************************************************************************

const distFolder = path.join(process.cwd(), './dist');
const indexHtml = path.join(distFolder, 'index.html');
app.use(favicon(path.join(distFolder, 'favicon.ico')));

app.get('*.*', express.static(distFolder, {
    maxAge: '1y'
}));

app.get('*', (req, res) => {
    res.sendFile(indexHtml);
});


// *************************************************************************************************************
// run the  server
// *************************************************************************************************************
const port = process.env.PORT || 4005;

app.listen(port, () => console.log('LISTEN TO http://localhost:4005 - TRAINING LBOD'));